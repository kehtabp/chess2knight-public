let e=null,t=null,n=navigator.language||"en-US",i=[],r=new Set;function a(){try{if(void 0!==Intl.Locale)try{const e=new Intl.Locale(n);if(e.weekInfo&&void 0!==e.weekInfo.firstDay)return 7===e.weekInfo.firstDay?0:e.weekInfo.firstDay}catch(e){}const e=n.toLowerCase().split("-"),t=e[0],i=e[1];return i&&["us","ca","ph","jp","kr","th","tw","il","sa","ae","kw","qa","bh","om","jo","lb","sy","iq","ye","eg","ly","sd","ma","dz","tn","so","dj","er","et","ke","tz","ug","rw","bi","mw","zm","zw","bw","sz","ls","mg","mu","sc","mz","ao","na","za"].includes(i)||["ja","ko","th"].includes(t)&&!i?0:"en"!==t||i&&!["us","ca","ph"].includes(i)?1:0}catch(e){return 1}}let o=new Intl.DateTimeFormat(n,{weekday:"long",year:"numeric",month:"long",day:"numeric"});function s(e){try{if(!e)return"";if("string"==typeof e){const t=new Date(e);if(isNaN(t.getTime()))return"";e=t}return o.format(e)}catch(e){return""}}function l(e){try{let t,i,r,a,o;return e.rrule?(t=new Date(e.rrule.dtstart),i=new Date(t.getTime()+108e5),r=!1,a=!0):(t=new Date(e.start),i=new Date(e.end),r="string"!=typeof e.start||!e.start.includes("T"),a=!1),a?o=`Every ${t.toLocaleDateString(n,{weekday:"long"})} at ${t.toLocaleTimeString(n,{hour:"2-digit",minute:"2-digit"})}`:(o=s(t),r||(o+=` ${t.toLocaleTimeString(n,{hour:"2-digit",minute:"2-digit"})}`)),`\n            <div class="popup-content">\n                <h3>${e.title}</h3>\n                <p>${o}</p>\n                ${r||a?"":`<p>Ends: ${s(i)} ${i.toLocaleTimeString(n,{hour:"2-digit",minute:"2-digit"})}</p>`}\n                ${e.website?`<p><a href="${e.website}" target="_blank" rel="noopener noreferrer">üåê Visit Website</a></p>`:""}\n                ${e.socials?`\n                    <div class="social-links">\n                        ${e.socials.facebook?`<a href="${e.socials.facebook}" target="_blank" rel="noopener noreferrer" title="Facebook">üìò</a>`:""}\n                        ${e.socials.twitter?`<a href="${e.socials.twitter}" target="_blank" rel="noopener noreferrer" title="Twitter">üê¶</a>`:""}\n                        ${e.socials.instagram?`<a href="${e.socials.instagram}" target="_blank" rel="noopener noreferrer" title="Instagram">üì∏</a>`:""}\n                    </div>\n                `:""}\n            </div>\n        `}catch(t){return`<div class="popup-content"><h3>${e.title}</h3></div>`}}function d(t){const n=document.getElementById("calendar");if(!n)return;let o;return i=t,e=new FullCalendar.Calendar(n,{initialView:window.innerWidth<=768?"listWeek":"dayGridMonth",headerToolbar:{left:window.innerWidth<=768?"prev,next":"prev,next today",center:"title",right:window.innerWidth<=768?"today":""},height:"100%",expandRows:!1,stickyHeaderDates:!1,nowIndicator:!0,handleWindowResize:!0,dayMaxEvents:window.innerWidth<=768&&3,eventDisplay:"block",displayEventEnd:!1,eventTimeFormat:{hour:"2-digit",minute:"2-digit",hour12:!0},initialDate:new Date,firstDay:a(),fixedWeekCount:!1,showNonCurrentDates:!1,views:{listWeek:{listDayFormat:{weekday:"long"},listDaySideFormat:{month:"short",day:"numeric"},noEventsMessage:"No events this week"}},eventDidMount:function(e){},eventClick:function(e){e.event.id&&window.showMarkerPopup&&window.showMarkerPopup(e.event.id)},eventContent:function(e){const t=e.event.extendedProps.type;return{html:`\n                    <div class="fc-event-main-frame">\n                        <div class="fc-event-title-container">\n                            <div class="fc-event-title fc-sticky">\n                                ${e.event.title} \n                                <span class="event-type">${t}</span>\n                            </div>\n                        </div>\n                    </div>\n                `}}}),e.render(),window.addEventListener("mapBoundsChanged",(e=>{r=new Set(e.detail.visibleEventIds),c(i)})),window.addEventListener("resize",(()=>{clearTimeout(o),o=setTimeout((()=>{if(e){const t=e.getDate(),n=e.view.type,i=window.innerWidth<=768,r=e.getEvents().map((e=>({id:e.id,title:e.title,start:e.start,end:e.end,backgroundColor:e.backgroundColor,borderColor:e.borderColor,extendedProps:e.extendedProps})));!i||"dayGridMonth"!==n&&"dayGridWeek"!==n?i||"listWeek"!==n||e.changeView("dayGridMonth"):e.changeView("listWeek"),e.setOption("headerToolbar",{left:i?"prev,next":"prev,next today",center:"title",right:i?"today":""}),e.setOption("dayMaxEvents",!!i&&3),e.setOption("expandRows",!i),e.setOption("displayEventEnd",!i),e.updateSize(),e.gotoDate(t),setTimeout((()=>{e.getEvents().length!==r.length&&window.updateEventsDisplay&&window.updateEventsDisplay()}),50)}}),100)})),c(t),e}function c(t){if(e){e.removeAllEvents();const n=t.filter((e=>!(!e.rrule||!r.has(e.id))||r.has(e.id))).map((e=>{const t={id:e.id,title:e.title,backgroundColor:u(e.type),borderColor:"transparent"};if(e.rrule){const n={freq:e.rrule.freq,dtstart:e.rrule.dtstart,interval:e.rrule.interval||1};return e.rrule.byweekday&&(n.byweekday=e.rrule.byweekday),e.rrule.until&&(n.until=e.rrule.until),{...t,rrule:n,duration:"03:00",extendedProps:{type:e.type,location:e.location,website:e.website,socials:e.socials,isRecurring:!0}}}return{...t,start:e.start,end:e.end,allDay:!e.start.includes("T"),extendedProps:{type:e.type,location:e.location,website:e.website,socials:e.socials,isRecurring:!1}}}));e.addEventSource({events:n})}}function u(e){return{tournament:"#e74c3c",casual:"#3498db",workshop:"#2ecc71",club:"#9b59b6"}[e]||"#95a5a6"}function w(t){if(!e)return;const n=new Date,i=n.getDay()-(t||0),r=new Date(n);r.setDate(n.getDate()-i),e.gotoDate(r)}export{d as initCalendar,c as updateEventDisplay,w as setCalendarToStartOfWeek,l as createPopupContent,a as getLocaleFirstDay};